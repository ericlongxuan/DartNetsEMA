<!DOCTYPE html>
<html>
  <head>
    <title>Student Life EMA Manager</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="css/my-site.css" rel="stylesheet">
    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/handlebars-v4.0.5.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- import js initialization and functions -->
    <script src="js/my-site/handlerbars-helper.js"></script>
    <script src="js/my-site/common.js"></script>
    <script src="js/my-site/index.js"></script>
  </head>
  <body>
    <div class="container">
      <!-- Common Top Nav -->
      <script id="common-tpl" type="text/x-handlebars-template"></script>
      <script type="text/javascript">
      $.get("common.tpl", function(response){
      $("#common-tpl").html(response);
      common.init();
      });
      // var localFileAccessMsg = "You should permit javascript access to local files. ANY of the following approches should work:\n"
      // + "(1) Please use --allow-file-access-from-files for chrome\n"
      // + "(See: http://blog.derraab.com/2013/05/30/start-google-chrome-with-local-file-access-on-mac-os-x/)\n"
      // + "(2) use safari or firefox to permit access to local files.\n"
      // + "(3) run a local Http server in the folder where index.html is.(for examle 'python -m SimpleHTTPServer')\n"
      // + "and open this page using localhost:8000 in browser.";
      // $.holdReady(true);
      // $.get("common.tpl")
      // .done(
      // function(response){$("#common-tpl").html(response);
      // $.holdReady(false);})
      // .fail(
      // function() {alert(localFileAccessMsg);}
      // );
      </script>
      <script id="index-tpl" type="text/x-handlebars-template">
      <div class="body-content">
        <!-- Sidebar -->
        <div class="col-md-3">
          <div class="sidebar affix">
            <div class="panel panel-primary">
              <!-- Sidebar Head -->
              <div class="panel-heading">Category
                <button type="text" class="btn btn-success btn-xs btn-icon" id="cat-add-btn"
                data-toggle="tooltip" data-placement="bottom" title="Add">
                <span class="glyphicon glyphicon-plus"></span>
                </button>
              </div>
              <div class="panel-body">
                <ul class="nav nav-stacked">
                  {{#each EMAScheduleList}}
                  <li><a data-href="{{EMADef.Name}}">
                    <span class="glyphicon glyphicon-list"></span> {{EMADef.Name}}
                  </a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-8 main">
          {{#each EMAScheduleList}}
          <div class="panel panel-primary">
            <div class="panel-heading" id="{{EMADef.Name}}">{{EMADef.Name}}
              <button type="text" class="btn btn-danger btn-xs btn-icon cat-del-btn" data-catindex="{{@index}}"
              data-toggle="tooltip" data-placement="bottom" title="Edit">
              <span class="glyphicon glyphicon-trash"></span>
              </button>
              <button type="text" class="btn btn-default btn-xs btn-icon cat-disable-btn" data-catindex="{{@index}}"
              data-toggle="tooltip" data-placement="bottom" title="Disable">
              <span class="glyphicon glyphicon-eye-close"></span>
              </button>
              <button type="text" class="btn btn-warning btn-xs btn-icon cat-edit-btn" data-catindex="{{@index}}"
              data-toggle="tooltip" data-placement="bottom" title="Delete">
              <span class="glyphicon glyphicon-pencil"></span>
              </button>


            </div>
            <div class="panel-body">
              <p><label class="label label-info">Schedule</label></p>
              <p>
                <label>Random:</label>
                <select class="form-control">
                  <option {{#compare Random "daily" operator="=="}}selected{{/compare}}>daily</option>
                  <option {{#compare Random "weekly" operator="=="}}selected{{/compare}}>weekly</option>
                  <option {{#compare Random "" operator="=="}}selected{{/compare}}></option>
                </select>
              </p>
              <p>
                <label>HourOfDay:</label>
                <input type="text" class="form-control" value="{{HourOfDay}}"></input>
              </p>
              <p>
                <label>Minute:</label>
                <input type="text" class="form-control" value="{{Minute}}"></input>
              </p>
              <p>
                <label>Second:</label>
                <input type="text" class="form-control" value="{{Second}}"></input>
              </p>
              <hr>
              <p><label class="label label-info">EMADef</label></p>
              <p>
                <label>Name:</label>
                <input type="text" class="form-control" value="{{EMADef.Name}}"></input>
              </p>
              <p>
                <label>Prompt:</label>
                <input type="text" class="form-control" value="{{EMADef.Prompt}}"></input>
              </p>
              <p>
                <label>RandomGroup:</label>
                <input type="text" class="form-control" value="{{EMADef.RandomGroup}}"></input>
              </p>
              <hr>
              <!-- Tab panes -->
              <p>
                <p><label class="label label-info">QuestionGroup:</label></p>
                <ul class="nav nav-tabs nav-info" role="tablist">
                  {{#each EMADef.QuestionGroup}}
                  {{#compare this.length 1 operator=">"}}
                  <li role="tab" class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                      Group{{math @index "+" 1}}<span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      {{#each this}}
                      <li><a href="#G{{@../index}}Q{{@index}}" role="tab" data-toggle="tab">{{Name}}</a></li>
                      {{/each}}
                    </ul>
                  </li>
                  {{else}}
                  <li {{#compare @index "0" operator="=="}}class="active"{{/compare}}>
                    <a href="#G{{@index}}Q0" role="tab" data-toggle="tab">Group{{math @index "+" 1}}</a>
                  </li>
                  {{/compare}}
                  {{/each}}
                </ul>
                <div class="tab-content">
                  {{#each EMADef.QuestionGroup}}
                  {{#each this}}
                  <!-- active in fot the first element. indexes of outer loop and inner loop should both be 0-->
                  <div class="tab-pane {{#ifCond @../index "||" @index}}{{else}}active in{{/ifCond}} fade" id="G{{@../index}}Q{{@index}}">
                    <p>
                      <label>QuestionType:</label>
                      <input type="text" class="form-control" value="{{this.QuestionType}}"></input>
                    </p>
                    <p>
                      <label>Name:</label>
                      <input type="text" class="form-control" value="{{this.Name}}"></input>
                    </p>
                    <p>
                      <label>QuestionText:</label>
                      <input type="text" class="form-control" value="{{this.QuestionText}}"></input>
                    </p>
                  </div>
                  {{/each}}
                  {{/each}}
                </div>
              </p>
            </div>
          </div>
          {{/each}}
        </div>
      </div>
    </div>
    </script>
  </div>
</body>
</html>